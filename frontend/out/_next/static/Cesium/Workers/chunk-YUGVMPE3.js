import{a as e}from"./chunk-XTBKSAXL.js";import{a as t}from"./chunk-VRX6MZUH.js";import{a as r,b as n,f as o,g as a}from"./chunk-4PT23TTH.js";import{a as l,b as i,c as c,e as s}from"./chunk-I4JBCTLR.js";import{a as u}from"./chunk-MCEXFPZL.js";import{a as d}from"./chunk-BOXFFUY5.js";import{e as g}from"./chunk-OVZZEY7C.js";var m=Object.freeze({ROUNDED:0,MITERED:1,BEVELED:2}),h={};function y(e,t){if(!g(e))throw new d("identifier is required.");g(h[e])||(h[e]=!0,console.warn(t??e))}y.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",y.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",y.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",y.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var f=y,p=[new l,new l],w=new l,E=new l,x=new l,b=new l,B=new l,T=new l,z=new l,P=new l,S=new l,A=new l,R=new l,v={},D=new i;function O(e,t,r,n){let o=e[0],a=e[1],i=Math.ceil(l.angleBetween(o,a)/n),c=Array(i),s;if(t===r){for(s=0;s<i;s++)c[s]=t;return c.push(r),c}let u=(r-t)/i;for(s=1;s<i;s++){let e=t+s*u;c[s]=e}return c[0]=t,c.push(r),c}var j=new l,I=new l,V=new l(-1,0,0),H=new n,L=new n,N=new s,k=s.IDENTITY.clone(),F=new l,G=new r,M=new l;function U(e,r,o,i,u,d,g,m){var h;let y,f,p,w,E=F,x=G;H=a.eastNorthUpToFixedFrame(e,u,H),E=n.multiplyByPointAsVector(H,V,E);let b=(h=E=l.normalize(E,E),f=(y=new t(e,u)).projectPointOntoPlane(l.add(e,h,j),j),p=y.projectPointOntoPlane(l.add(e,r,I),I),w=c.angleBetween(f,p),p.x*f.y-p.y*f.x>=0?-w:w);N=s.fromRotationZ(b,N),M.z=d,H=n.multiplyTransformation(H,n.fromRotationTranslation(N,M,L),H),k[0]=g;for(let e=0;e<m;e++)for(let e=0;e<o.length;e+=3)x=l.fromArray(o,e,x),x=s.multiplyByVector(k,x,x),x=n.multiplyByPoint(H,x,x),i.push(x.x,x.y,x.z);return i}var Z=new l;function q(e,t,r,n,o,a,i){for(let c=0;c<e.length;c+=3)n=U(l.fromArray(e,c,Z),t,r,n,o,a[c/3],i,1);return n}function X(e,t){let r=e.length,n=Array(3*r),o=0,a=t.x+t.width/2,l=t.y+t.height/2;for(let t=0;t<r;t++)n[o++]=e[t].x-a,n[o++]=0,n[o++]=e[t].y-l;return n}var C=new o,Y=new l,_=new s;function Q(e,t,r,n,a,i,c,d,g,h){let y,f=l.angleBetween(l.subtract(t,e,A),l.subtract(r,e,R)),p=n===m.BEVELED?0:Math.ceil(f/u.toRadians(5)),w;if(w=a?s.fromQuaternion(o.fromAxisAngle(l.negate(e,A),f/(p+1),C),_):s.fromQuaternion(o.fromAxisAngle(e,f/(p+1),C),_),t=l.clone(t,Y),p>0){let r=h?2:1;for(let n=0;n<p;n++)t=s.multiplyByVector(w,t,t),y=l.subtract(t,e,A),y=l.normalize(y,y),a||(y=l.negate(y,y)),c=U(i.scaleToGeodeticSurface(t,R),y,d,c,i,g,1,r)}else y=l.subtract(t,e,A),y=l.normalize(y,y),a||(y=l.negate(y,y)),c=U(i.scaleToGeodeticSurface(t,R),y,d,c,i,g,1,1),r=l.clone(r,Y),y=l.subtract(r,e,A),y=l.normalize(y,y),a||(y=l.negate(y,y)),c=U(i.scaleToGeodeticSurface(r,R),y,d,c,i,g,1,1);return c}v.removeDuplicatesFromShape=function(e){let t=e.length,r=[];for(let n=t-1,o=0;o<t;n=o++){let t=e[n],a=e[o];c.equals(t,a)||r.push(a)}return r},v.angleIsGreaterThanPi=function(e,r,n,o){let a=new t(n,o),i=a.projectPointOntoPlane(l.add(n,e,j),j),c=a.projectPointOntoPlane(l.add(n,r,I),I);return c.x*i.y-c.y*i.x>=0};var J=new l,K=new l;v.computePositions=function(t,r,n,o,a){let i,c=o._ellipsoid,s=function(e,t){let r=Array(e.length);for(let n=0;n<e.length;n++){let o=e[n];D=t.cartesianToCartographic(o,D),r[n]=D.height,e[n]=t.scaleToGeodeticSurface(o,o)}return r}(t,c),d=o._granularity,g=o._cornerType,h=a?function(e,t){let r=e.length,n=Array(6*r),o=0,a=t.x+t.width/2,l=t.y+t.height/2,i=e[0];n[o++]=i.x-a,n[o++]=0,n[o++]=i.y-l;for(let t=1;t<r;t++){let r=(i=e[t]).x-a,c=i.y-l;n[o++]=r,n[o++]=0,n[o++]=c,n[o++]=r,n[o++]=0,n[o++]=c}return i=e[0],n[o++]=i.x-a,n[o++]=0,n[o++]=i.y-l,n}(r,n):X(r,n),y=a?X(r,n):void 0,R=n.height/2,j=n.width/2,I=t.length,V=[],H=a?[]:void 0,L=w,N=E,k=x,F=b,G=B,M=T,Z=z,C=P,Y=S,_=t[0],W=t[1];F=c.geodeticSurfaceNormal(_,F),L=l.subtract(W,_,L),L=l.normalize(L,L),C=l.cross(F,L,C),C=l.normalize(C,C);let $=s[0],ee=s[1];a&&(H=U(_,C,y,H,c,$+R,1,1)),Y=l.clone(_,Y),_=W,N=l.negate(L,N);for(let r=1;r<I-1;r++){let n=a?2:1;if(W=t[r+1],_.equals(W)){f("Positions are too close and are considered equivalent with rounding error.");continue}L=l.subtract(W,_,L),L=l.normalize(L,L),F=c.geodeticSurfaceNormal(_,F);let o=l.multiplyByScalar(F,l.dot(L,F),J);l.subtract(L,o,o),l.normalize(o,o);let y=l.multiplyByScalar(F,l.dot(N,F),K);if(l.subtract(N,y,y),l.normalize(y,y),u.equalsEpsilon(Math.abs(l.dot(o,y)),1,u.EPSILON7))V=U(Y,C,h,V,c,$+R,1,1),Y=_;else{k=l.add(L,N,k),k=l.normalize(k,k),k=l.cross(k,F,k),k=l.cross(F,k,k),k=l.normalize(k,k);let t=1/Math.max(.25,l.magnitude(l.cross(k,N,A))),r=v.angleIsGreaterThanPi(L,N,_,c);r?(G=l.add(_,l.multiplyByScalar(k,t*j,k),G),M=l.add(G,l.multiplyByScalar(C,j,M),M),p[0]=l.clone(Y,p[0]),p[1]=l.clone(M,p[1]),i=O(p,$+R,ee+R,d),V=q(e.generateArc({positions:p,granularity:d,ellipsoid:c}),C,h,V,c,i,1),C=l.cross(F,L,C),C=l.normalize(C,C),Z=l.add(G,l.multiplyByScalar(C,j,Z),Z),g===m.ROUNDED||g===m.BEVELED?Q(G,M,Z,g,r,c,V,h,ee+R,a):V=U(_,k=l.negate(k,k),h,V,c,ee+R,t,n)):(G=l.add(_,l.multiplyByScalar(k,t*j,k),G),M=l.add(G,l.multiplyByScalar(C,-j,M),M),p[0]=l.clone(Y,p[0]),p[1]=l.clone(M,p[1]),i=O(p,$+R,ee+R,d),V=q(e.generateArc({positions:p,granularity:d,ellipsoid:c}),C,h,V,c,i,1),C=l.cross(F,L,C),C=l.normalize(C,C),Z=l.add(G,l.multiplyByScalar(C,-j,Z),Z),g===m.ROUNDED||g===m.BEVELED?Q(G,M,Z,g,r,c,V,h,ee+R,a):V=U(_,k,h,V,c,ee+R,t,n)),Y=l.clone(Z,Y),N=l.negate(L,N)}$=ee,ee=s[r+1],_=W}p[0]=l.clone(Y,p[0]),p[1]=l.clone(_,p[1]),i=O(p,$+R,ee+R,d),V=q(e.generateArc({positions:p,granularity:d,ellipsoid:c}),C,h,V,c,i,1),a&&(H=U(_,C,y,H,c,ee+R,1,1)),I=V.length;let et=new Float64Array(a?I+H.length:I);return et.set(V),a&&et.set(H,I),et};var W=v;export{m as a,f as b,W as c};