import{a as t}from"./chunk-PCP6Y43Y.js";import{a as e}from"./chunk-HNJRTQHB.js";import{b as i}from"./chunk-AKNTYFRF.js";import"./chunk-MQ2J7IEP.js";import{a as r}from"./chunk-I4PVU2XE.js";import{a as o}from"./chunk-TMRGWDA2.js";import{b as n,c as a,d as s}from"./chunk-OST65WKL.js";import{d as l}from"./chunk-KLPRJ6SC.js";import{h as u}from"./chunk-4PT23TTH.js";import{a as c}from"./chunk-J4RA3VLE.js";import{a as h,b as p,d as f,f as d}from"./chunk-I4JBCTLR.js";import{a as g}from"./chunk-MCEXFPZL.js";import"./chunk-5IUKPU5Q.js";import"./chunk-B3NSNNUV.js";import{a as m}from"./chunk-BOXFFUY5.js";import{e as _}from"./chunk-OVZZEY7C.js";var b=new l,k=new l,w=new h,y=new u;function E(e,i){let l=e._ellipsoid,u=i.height,h=i.width,p=i.northCap,f=i.southCap,d=u,g=2,m=0,_=4;p&&(g-=1,d-=1,m+=1,_-=2),f&&(g-=1,d-=1,m+=1,_-=2);let b=new Float64Array(3*(m+=g*h+2*d-_)),k=0,y=0,E;if(p)t.computePosition(i,l,!1,y,0,w),b[k++]=w.x,b[k++]=w.y,b[k++]=w.z;else for(E=0;E<h;E++)t.computePosition(i,l,!1,y,E,w),b[k++]=w.x,b[k++]=w.y,b[k++]=w.z;for(E=h-1,y=1;y<u;y++)t.computePosition(i,l,!1,y,E,w),b[k++]=w.x,b[k++]=w.y,b[k++]=w.z;if(y=u-1,!f)for(E=h-2;E>=0;E--)t.computePosition(i,l,!1,y,E,w),b[k++]=w.x,b[k++]=w.y,b[k++]=w.z;for(E=0,y=u-2;y>0;y--)t.computePosition(i,l,!1,y,E,w),b[k++]=w.x,b[k++]=w.y,b[k++]=w.z;let A=b.length/3*2,v=r.createTypedArray(b.length/3,A),P=0;for(let t=0;t<b.length/3-1;t++)v[P++]=t,v[P++]=t+1;v[P++]=b.length/3-1,v[P++]=0;let N=new a({attributes:new o,primitiveType:n.LINES});return N.attributes.position=new s({componentDatatype:c.DOUBLE,componentsPerAttribute:3,values:b}),N.indices=v,N}function A(t){let e=(t=t??d.EMPTY_OBJECT).rectangle,i=t.granularity??g.RADIANS_PER_DEGREE,r=t.ellipsoid??f.default,o=t.rotation??0;if(!_(e))throw new m("rectangle is required.");if(u._validate(e),e.north<e.south)throw new m("options.rectangle.north must be greater than options.rectangle.south");let n=t.height??0,a=t.extrudedHeight??n;this._rectangle=u.clone(e),this._granularity=i,this._ellipsoid=r,this._surfaceHeight=Math.max(n,a),this._rotation=o,this._extrudedHeight=Math.min(n,a),this._offsetAttribute=t.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}A.packedLength=u.packedLength+f.packedLength+5,A.pack=function(t,e,i){if(!_(t))throw new m("value is required");if(!_(e))throw new m("array is required");return i=i??0,u.pack(t._rectangle,e,i),i+=u.packedLength,f.pack(t._ellipsoid,e,i),i+=f.packedLength,e[i++]=t._granularity,e[i++]=t._surfaceHeight,e[i++]=t._rotation,e[i++]=t._extrudedHeight,e[i]=t._offsetAttribute??-1,e};var v=new u,P=f.clone(f.UNIT_SPHERE),N={rectangle:v,ellipsoid:P,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};A.unpack=function(t,e,i){if(!_(t))throw new m("array is required");e=e??0;let r=u.unpack(t,e,v);e+=u.packedLength;let o=f.unpack(t,e,P);e+=f.packedLength;let n=t[e++],a=t[e++],s=t[e++],l=t[e++],c=t[e];return _(i)?(i._rectangle=u.clone(r,i._rectangle),i._ellipsoid=f.clone(o,i._ellipsoid),i._surfaceHeight=a,i._rotation=s,i._extrudedHeight=l,i._offsetAttribute=-1===c?void 0:c,i):(N.granularity=n,N.height=a,N.rotation=s,N.extrudedHeight=l,N.offsetAttribute=-1===c?void 0:c,new A(N))};var T=new p;A.createGeometry=function(o){let u=o._rectangle,h=o._ellipsoid,p=t.computeOptions(u,o._granularity,o._rotation,0,y,T),f,d;if(g.equalsEpsilon(u.north,u.south,g.EPSILON10)||g.equalsEpsilon(u.east,u.west,g.EPSILON10))return;let m=o._surfaceHeight,w=o._extrudedHeight,A;if(g.equalsEpsilon(m,w,0,g.EPSILON2)){if((f=E(o,p)).attributes.position.values=i.scaleToGeodeticHeight(f.attributes.position.values,m,h,!1),_(o._offsetAttribute)){let t=f.attributes.position.values.length;A=o._offsetAttribute===e.NONE?0:1;let i=new Uint8Array(t/3).fill(A);f.attributes.applyOffset=new s({componentDatatype:c.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}d=l.fromRectangle3D(u,h,m)}else{if(f=function(t,e){let o,n=t._surfaceHeight,a=t._extrudedHeight,s=t._ellipsoid,l=E(t,e),u=e.height,c=e.width,h=i.scaleToGeodeticHeight(l.attributes.position.values,n,s,!1),p=h.length,f=new Float64Array(2*p);f.set(h);let d=i.scaleToGeodeticHeight(l.attributes.position.values,a,s);f.set(d,p),l.attributes.position.values=f;let g=e.northCap,m=e.southCap,_=4;g&&(_-=1),m&&(_-=1);let b=(f.length/3+_)*2,k=r.createTypedArray(f.length/3,b);p=f.length/6;let w=0;for(let t=0;t<p-1;t++)k[w++]=t,k[w++]=t+1,k[w++]=t+p,k[w++]=t+p+1;if(k[w++]=p-1,k[w++]=0,k[w++]=p+p-1,k[w++]=p,k[w++]=0,k[w++]=p,g)o=u-1;else{let t=c-1;k[w++]=t,k[w++]=t+p,o=c+u-2}if(k[w++]=o,k[w++]=o+p,!m){let t=c+o-1;k[w++]=t,k[w]=t+p}return l.indices=k,l}(o,p),_(o._offsetAttribute)){let t=f.attributes.position.values.length/3,i=new Uint8Array(t);o._offsetAttribute===e.TOP?i=i.fill(1,0,t/2):(A=o._offsetAttribute===e.NONE?0:1,i=i.fill(A)),f.attributes.applyOffset=new s({componentDatatype:c.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}let t=l.fromRectangle3D(u,h,m,k),n=l.fromRectangle3D(u,h,w,b);d=l.union(t,n)}return new a({attributes:f.attributes,indices:f.indices,primitiveType:n.LINES,boundingSphere:d,offsetAttribute:o._offsetAttribute})};var H=function(t,e){return _(e)&&(t=A.unpack(t,e)),t._ellipsoid=f.clone(t._ellipsoid),t._rectangle=u.clone(t._rectangle),A.createGeometry(t)};export{H as default};