import{a as t}from"./chunk-YL52S4YJ.js";import{a as e}from"./chunk-YUGVMPE3.js";import"./chunk-XTBKSAXL.js";import"./chunk-F27AWPUY.js";import{a as i}from"./chunk-HNJRTQHB.js";import"./chunk-VRX6MZUH.js";import"./chunk-EMIRY7IE.js";import{b as r}from"./chunk-AKNTYFRF.js";import{a as o}from"./chunk-VKBMYYL4.js";import"./chunk-MQ2J7IEP.js";import"./chunk-LHHREGTA.js";import"./chunk-O2LOQWK4.js";import{a as s}from"./chunk-I4PVU2XE.js";import{a as n}from"./chunk-TMRGWDA2.js";import{b as a,c as l,d as h}from"./chunk-OST65WKL.js";import{d as u}from"./chunk-KLPRJ6SC.js";import"./chunk-4PT23TTH.js";import{a as p}from"./chunk-J4RA3VLE.js";import{a as f,d as c,f as d}from"./chunk-I4JBCTLR.js";import{a as g}from"./chunk-MCEXFPZL.js";import"./chunk-5IUKPU5Q.js";import"./chunk-B3NSNNUV.js";import{b as m}from"./chunk-BOXFFUY5.js";import{e as y}from"./chunk-OVZZEY7C.js";var A=new f,_=new f,b=new f;function k(i,r){let o=[],a=i.positions,l=i.corners,u=i.endPositions,c=new n,d,g=0,m=0,k,E=0,T;for(k=0;k<a.length;k+=2)g+=T=a[k].length-3,E+=T/3*4,m+=a[k+1].length-3;for(g+=3,m+=3,k=0;k<l.length;k++){d=l[k];let t=l[k].leftPositions;y(t)?g+=T=t.length:m+=T=l[k].rightPositions.length,E+=T/3*2}let j=y(u),v;j&&(g+=v=u[0].length-3,m+=v,v/=3,E+=4*v);let w=g+m,P=new Float64Array(w),L=0,O=w-1,H,N,U,I,R,D,G=v/2,S=s.createTypedArray(w/3,E+4),Y=0;if(S[Y++]=L/3,S[Y++]=(O-2)/3,j){o.push(L/3),D=A,R=_;let e=u[0];for(k=0;k<G;k++)D=f.fromArray(e,(G-1-k)*3,D),R=f.fromArray(e,(G+k)*3,R),t.addAttribute(P,R,L),t.addAttribute(P,D,void 0,O),I=(N=L/3)+1,U=(H=(O-2)/3)-1,S[Y++]=H,S[Y++]=U,S[Y++]=N,S[Y++]=I,L+=3,O-=3}let B=0,M=a[B++],x=a[B++];for(P.set(M,L),P.set(x,O-x.length+1),T=x.length-3,o.push(L/3,(O-2)/3),k=0;k<T;k+=3)I=(N=L/3)+1,U=(H=(O-2)/3)-1,S[Y++]=H,S[Y++]=U,S[Y++]=N,S[Y++]=I,L+=3,O-=3;for(k=0;k<l.length;k++){let i;let s=(d=l[k]).leftPositions,n=d.rightPositions,h,u=b;if(y(s)){for(O-=3,h=U,o.push(I),i=0;i<s.length/3;i++)u=f.fromArray(s,3*i,u),S[Y++]=h-i-1,S[Y++]=h-i,t.addAttribute(P,u,void 0,O),O-=3;o.push(h-Math.floor(s.length/6)),r===e.BEVELED&&o.push((O-2)/3+1),L+=3}else{for(L+=3,h=I,o.push(U),i=0;i<n.length/3;i++)u=f.fromArray(n,3*i,u),S[Y++]=h+i,S[Y++]=h+i+1,t.addAttribute(P,u,L),L+=3;o.push(h+Math.floor(n.length/6)),r===e.BEVELED&&o.push(L/3-1),O-=3}for(M=a[B++],x=a[B++],M.splice(0,3),x.splice(x.length-3,3),P.set(M,L),P.set(x,O-x.length+1),T=x.length-3,i=0;i<x.length;i+=3)N=(I=L/3)-1,H=(U=(O-2)/3)+1,S[Y++]=H,S[Y++]=U,S[Y++]=N,S[Y++]=I,L+=3,O-=3;L-=3,O+=3,o.push(L/3,(O-2)/3)}if(j){L+=3,O-=3,D=A,R=_;let e=u[1];for(k=0;k<G;k++)D=f.fromArray(e,(v-k-1)*3,D),R=f.fromArray(e,3*k,R),t.addAttribute(P,D,void 0,O),t.addAttribute(P,R,L),N=(I=L/3)-1,H=(U=(O-2)/3)+1,S[Y++]=H,S[Y++]=U,S[Y++]=N,S[Y++]=I,L+=3,O-=3;o.push(L/3)}else o.push(L/3,(O-2)/3);return S[Y++]=L/3,S[Y++]=(O-2)/3,c.position=new h({componentDatatype:p.DOUBLE,componentsPerAttribute:3,values:P}),{attributes:c,indices:S,wallIndices:o}}function E(t){let i=(t=t??d.EMPTY_OBJECT).positions,r=t.width;m.typeOf.object("options.positions",i),m.typeOf.number("options.width",r);let o=t.height??0,s=t.extrudedHeight??o;this._positions=i,this._ellipsoid=c.clone(t.ellipsoid??c.default),this._width=r,this._height=Math.max(o,s),this._extrudedHeight=Math.min(o,s),this._cornerType=t.cornerType??e.ROUNDED,this._granularity=t.granularity??g.RADIANS_PER_DEGREE,this._offsetAttribute=t.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+i.length*f.packedLength+c.packedLength+6}E.pack=function(t,e,i){m.typeOf.object("value",t),m.typeOf.object("array",e),i=i??0;let r=t._positions,o=r.length;e[i++]=o;for(let t=0;t<o;++t,i+=f.packedLength)f.pack(r[t],e,i);return c.pack(t._ellipsoid,e,i),i+=c.packedLength,e[i++]=t._width,e[i++]=t._height,e[i++]=t._extrudedHeight,e[i++]=t._cornerType,e[i++]=t._granularity,e[i]=t._offsetAttribute??-1,e};var T=c.clone(c.UNIT_SPHERE),j={positions:void 0,ellipsoid:T,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};E.unpack=function(t,e,i){m.typeOf.object("array",t),e=e??0;let r=t[e++],o=Array(r);for(let i=0;i<r;++i,e+=f.packedLength)o[i]=f.unpack(t,e);let s=c.unpack(t,e,T);e+=c.packedLength;let n=t[e++],a=t[e++],l=t[e++],h=t[e++],u=t[e++],p=t[e];return y(i)?(i._positions=o,i._ellipsoid=c.clone(s,i._ellipsoid),i._width=n,i._height=a,i._extrudedHeight=l,i._cornerType=h,i._granularity=u,i._offsetAttribute=-1===p?void 0:p,i):(j.positions=o,j.width=n,j.height=a,j.extrudedHeight=l,j.cornerType=h,j.granularity=u,j.offsetAttribute=-1===p?void 0:p,new E(j))},E.createGeometry=function(e){let n=e._positions,c=e._width,d=e._ellipsoid,m=o(n=function(t,e){for(let i=0;i<t.length;i++)t[i]=e.scaleToGeodeticSurface(t[i],t[i]);return t}(n,d),f.equalsEpsilon);if(m.length<2||c<=0)return;let A=e._height,_=e._extrudedHeight,b=!g.equalsEpsilon(A,_,0,g.EPSILON2),E={ellipsoid:d,positions:m,width:c,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1},T;if(b)E.height=A,E.extrudedHeight=_,E.offsetAttribute=e._offsetAttribute,T=function(e){let o,n,a=e.ellipsoid,l=k(t.computePositions(e),e.cornerType),u=l.wallIndices,f=e.height,c=e.extrudedHeight,d=l.attributes,g=l.indices,m=d.position.values,A=m.length,_=new Float64Array(A);_.set(m);let b=new Float64Array(2*A);if(m=r.scaleToGeodeticHeight(m,f,a),_=r.scaleToGeodeticHeight(_,c,a),b.set(m),b.set(_,A),d.position.values=b,A/=3,y(e.offsetAttribute)){let t=new Uint8Array(2*A);if(e.offsetAttribute===i.TOP)t=t.fill(1,0,A);else{let r=e.offsetAttribute===i.NONE?0:1;t=t.fill(r)}d.applyOffset=new h({componentDatatype:p.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}let E,T=g.length,j=s.createTypedArray(b.length/3,(T+u.length)*2);j.set(g);let v=T;for(E=0;E<T;E+=2){let t=g[E],e=g[E+1];j[v++]=t+A,j[v++]=e+A}for(E=0;E<u.length;E++)n=(o=u[E])+A,j[v++]=o,j[v++]=n;return{attributes:d,indices:j}}(E);else if((T=k(t.computePositions(E),E.cornerType)).attributes.position.values=r.scaleToGeodeticHeight(T.attributes.position.values,A,d),y(e._offsetAttribute)){let t=T.attributes.position.values.length,r=e._offsetAttribute===i.NONE?0:1,o=new Uint8Array(t/3).fill(r);T.attributes.applyOffset=new h({componentDatatype:p.UNSIGNED_BYTE,componentsPerAttribute:1,values:o})}let j=T.attributes,v=u.fromVertices(j.position.values,void 0,3);return new l({attributes:j,indices:T.indices,primitiveType:a.LINES,boundingSphere:v,offsetAttribute:e._offsetAttribute})};var v=function(t,e){return y(e)&&(t=E.unpack(t,e)),t._ellipsoid=c.clone(t._ellipsoid),E.createGeometry(t)};export{v as default};