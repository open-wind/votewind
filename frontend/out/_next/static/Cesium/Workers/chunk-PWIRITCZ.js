import{f as e}from"./chunk-4PT23TTH.js";import{a as t,e as r}from"./chunk-I4JBCTLR.js";import{a as a}from"./chunk-MCEXFPZL.js";var o={},i=new t,l=new t,n=new e,s=new r;function y(a,o,y,c,m,u,x,h,f,z){let _=a+o;t.multiplyByScalar(c,Math.cos(_),i),t.multiplyByScalar(y,Math.sin(_),l),t.add(i,l,i);let p=Math.cos(a);p*=p;let O=Math.sin(a);O*=O;let P=u/Math.sqrt(x*p+m*O)/h;return e.fromAxisAngle(i,P,n),r.fromQuaternion(n,s),r.multiplyByVector(s,f,z),t.normalize(z,z),t.multiplyByScalar(z,h,z),z}var c=new t,m=new t,u=new t,x=new t;o.raisePositionsToHeight=function(e,r,a){let o=r.ellipsoid,i=r.height,l=r.extrudedHeight,n=new Float64Array(3*(a?e.length/3*2:e.length/3)),s=e.length,y=a?s:0;for(let r=0;r<s;r+=3){let s=r+1,h=r+2,f=t.fromArray(e,r,c);o.scaleToGeodeticSurface(f,f);let z=t.clone(f,m),_=o.geodeticSurfaceNormal(f,x),p=t.multiplyByScalar(_,i,u);t.add(f,p,f),a&&(t.multiplyByScalar(_,l,p),t.add(z,p,z),n[r+y]=z.x,n[s+y]=z.y,n[h+y]=z.z),n[r]=f.x,n[s]=f.y,n[h]=f.z}return n};var h=new t,f=new t,z=new t;o.computeEllipsePositions=function(e,r,o){let i=e.semiMinorAxis,l=e.semiMajorAxis,n=e.rotation,s=e.center,x=8*e.granularity,_=i*i,p=l*l,O=l*i,P=t.magnitude(s),T=t.normalize(s,h),d=t.cross(t.UNIT_Z,s,f);d=t.normalize(d,d);let M=t.cross(T,d,z),w=1+Math.ceil(a.PI_OVER_TWO/x),I=a.PI_OVER_TWO/(w-1),g=a.PI_OVER_TWO-w*I;g<0&&(w-=Math.ceil(Math.abs(g)/I));let E=w*(w+2)*2,R=r?Array(3*E):void 0,V=0,A=c,W=m,B=12*w,S=B-1,v=0,j=o?Array(B):void 0,k,H,C,F,L;for(A=y(g=a.PI_OVER_TWO,n,M,d,_,O,p,P,T,A),r&&(R[V++]=A.x,R[V++]=A.y,R[V++]=A.z),o&&(j[S--]=A.z,j[S--]=A.y,j[S--]=A.x),g=a.PI_OVER_TWO-I,k=1;k<w+1;++k){if(A=y(g,n,M,d,_,O,p,P,T,A),W=y(Math.PI-g,n,M,d,_,O,p,P,T,W),r){for(R[V++]=A.x,R[V++]=A.y,R[V++]=A.z,C=2*k+2,H=1;H<C-1;++H)F=H/(C-1),L=t.lerp(A,W,F,u),R[V++]=L.x,R[V++]=L.y,R[V++]=L.z;R[V++]=W.x,R[V++]=W.y,R[V++]=W.z}o&&(j[S--]=A.z,j[S--]=A.y,j[S--]=A.x,j[v++]=W.x,j[v++]=W.y,j[v++]=W.z),g=a.PI_OVER_TWO-(k+1)*I}for(k=w;k>1;--k){if(A=y(-(g=a.PI_OVER_TWO-(k-1)*I),n,M,d,_,O,p,P,T,A),W=y(g+Math.PI,n,M,d,_,O,p,P,T,W),r){for(R[V++]=A.x,R[V++]=A.y,R[V++]=A.z,C=2*(k-1)+2,H=1;H<C-1;++H)F=H/(C-1),L=t.lerp(A,W,F,u),R[V++]=L.x,R[V++]=L.y,R[V++]=L.z;R[V++]=W.x,R[V++]=W.y,R[V++]=W.z}o&&(j[S--]=A.z,j[S--]=A.y,j[S--]=A.x,j[v++]=W.x,j[v++]=W.y,j[v++]=W.z)}A=y(-(g=a.PI_OVER_TWO),n,M,d,_,O,p,P,T,A);let N={};return r&&(R[V++]=A.x,R[V++]=A.y,R[V++]=A.z,N.positions=R,N.numPts=w),o&&(j[S--]=A.z,j[S--]=A.y,j[S--]=A.x,N.outerPositions=j),N};var _=o;export{_ as a};